import t from"@skatejs/val";import{html as e,LitElement as n}from"lit";import{AXAPopupMixin as a,AXAPopupButton as i,AXAPopupContent as r}from"@axa-ch/popup";import{classMap as o}from"lit/directives/class-map.js";import{unsafeHTML as s}from"lit/directives/unsafe-html.js";var u=(t,e)=>{const n=t.toLowerCase();return window.customElements.get(n)||window.customElements.define(n,e),n};const p=(t,e)=>{return`${t}-${n=e,`${n}`.replace(/\./g,"-").replace(/[^A-Za-z0-9-]/g,"")}`;var n},l=(t,e="",n="<")=>`${n}${e}${t}`,c=(t,e,n)=>l(p(t,e),n,"{"),h=(t,e,n)=>t.map((t=>t.split(l(e)).join(c(e,n)).split(l(e,"/")).join(c(e,n,"/")))),d=(t,e,n)=>{const a="string"==typeof e&&e;let i="";return t.forEach((t=>{const r=t instanceof HTMLElement?t.constructor:t,{tagName:o}=r,s=!a&&e[o];if(s){if(!window.customElements.get(o)&&r.versions)throw Error(`'versions' is a reserved class property, but was found in ${o}'s class`);r.versions=s,u(o,r)}let{versions:l}=r;!l&&n&&(l=e[n.constructor.tagName],l[o]=Object.values(l)[0]);const c=a||l[o];i=p(o,c),u(i,class extends r{})})),i},x=t=>(n,...a)=>{const i=t.constructor,[r,o]=(t=>{const{versions:e,tagName:n}=t,a=Object.keys(e).filter((t=>t!==n)).sort(((t,e)=>e.length-t.length));return[a,a.map((t=>e[t]))]})(i);let s=n;for(let t=0,e=r.length;t<e;t++)s=h(s,r[t],o[t]);for(let t=0,e=s.length;t<e;t++)s[t]=s[t].split("{").join("<");return s.raw=s,e(s,...a)},f=(t,e)=>{const n={},a={};let i;return Object.keys(t).forEach((r=>{const o=t[r];let s;const u=e.properties[r]||{},{type:p}=u;switch(s=0===r.indexOf("on")&&r.charAt(2)===r.charAt(2).toUpperCase()?Function:"className"===r?"className":p,s){case"className":case Array:case Object:case Function:case Boolean:i=a;break;default:i=p?a:n}void 0!==o&&(i[r]="style"===r?(t=>Object.keys(t).reduce(((e,n)=>{let a=e;return`${a+=n.split(/(?=[A-Z])/).join("-").toLowerCase()}:${t[n]};`}),""))(o):o)})),{attrs:n,props:a}};var m=(t="")=>`${t}${Math.random().toString(36).slice(2)}`;const g={};class _ extends n{inlineStyles(t="styles"){const e=this.getRootNode(),n=g[this.tagName]||new WeakMap,a=n.get(e)||{},i=(a.referenceCount||0)+1;if(a.referenceCount=i,n.set(e,i),g[this.tagName]=n,1===i){this.ownerDocument!==e&&(this._rootNode=e);const n=document.createElement("style");let i=this.constructor[t];const r=this.nodeName.toLowerCase(),o=this.constructor.tagName;r!==o&&(i=i.split(o).join(r)),n.textContent=i,n.dataset.name=this.tagName.toLowerCase();(e instanceof ShadowRoot?e:document.head).appendChild(n),a.style=n}n.set(e,a),g[this.tagName]=n}disconnectedCallback(){super.disconnectedCallback();const t=g[this.tagName];if(!t)return;const e=this._rootNode||this.ownerDocument,n=t.get(e)||{},a=(n.referenceCount||0)-1;if(a<1){t.delete(e);const{style:a}=n;a&&a.parentNode&&a.parentNode.removeChild(a)}else n.referenceCount=a,t.set(e,n)}}class v extends _{connectedCallback(){super.connectedCallback(),this.inlineStyles()}createRenderRoot(){return this}}const y=t=>!(null==t),b=new Map;[[String,""],[Boolean,!1],[Object,{}],[Array,[]],[Number,0],[Function,()=>{}]].forEach((([t,e])=>{b.set(t,e)}));const $=()=>{},C=t=>{const{constructor:{properties:e}}=t;Object.keys(e).forEach((n=>{const a=e[n],{type:i,converter:r,defaultValue:o}=a;if(!i){if(!r)throw new Error(`<${t.nodeName}> property "${n}" is missing a type!`);return}let s=t[n];y(s)||(s=i===Boolean?t.hasAttribute(n):t.getAttribute(n),y(s)?t[n]=((t,e)=>e===Number?parseFloat(t):e===Function?$:e===Array||e===Object?JSON.parse(t):t)(s,i):void 0===o&&"defaultValue"in a||(t[n]="defaultValue"in a?o:b.get(i)))}))};const w=".*";class k extends(a(v)){static get tagName(){return"axa-input-text"}static get properties(){return{refId:{type:String,defaultValue:`input-text-${m()}`},name:{type:String},label:{type:String},required:{type:Boolean},placeholder:{type:String},value:{type:String,defaultValue:void 0},defaultValue:{type:String},type:{type:String,defaultValue:"text"},error:{type:String},info:{type:String},invalid:{type:Boolean},checkMark:{type:Boolean},disabled:{type:Boolean,reflect:!0},isReact:{type:Boolean},modelCounter:{type:String},counter:{type:String},counterMax:{type:String},maxLength:{converter:t=>!isNaN(parseFloat(t))&&isFinite(t)?Number(t):void 0},inputmode:{type:String},currency:{type:String},pattern:{converter:t=>t||w},autofocus:{type:Boolean},readonly:{type:Boolean},onChange:{type:Function,attribute:!1},onFocus:{type:Function,attribute:!1},onBlur:{type:Function,attribute:!1},onKeyUp:{type:Function,attribute:!1}}}static get styles(){return'axa-input-text .a-input-text__input-wrapper {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\naxa-input-text .a-input-text__input-elements {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\naxa-input-text .a-input-text__info-button {\n  margin-left: 10px;\n  width: 32px;\n  height: 32px;\n}\naxa-input-text .a-input-text__input {\n  font-size: 14px;\n  letter-spacing: 0.02em;\n  line-height: 17px;\n  font-family: "Source Sans Pro", Arial, sans-serif;\n  appearance: none;\n  background: #fff;\n  border: 1px solid #999;\n  border-radius: 0;\n  box-sizing: border-box;\n  color: #333;\n  height: 40px;\n  padding: 0 20px;\n  width: 100%;\n}\naxa-input-text .a-input-text__input::placeholder {\n  color: #999;\n}\naxa-input-text .a-input-text__input::-ms-clear {\n  display: none;\n}\naxa-input-text .a-input-text__input:hover, axa-input-text .a-input-text__input:active, axa-input-text .a-input-text__input:focus {\n  border: 1px solid #00008f;\n}\naxa-input-text .a-input-text__input:focus, axa-input-text .a-input-text__input.focus {\n  border: 1px solid #00008f;\n  outline: 1px solid #00008f;\n  outline-offset: -2px;\n}\naxa-input-text .a-input-text__input--error {\n  border: 1px solid #c91432;\n}\naxa-input-text .a-input-text__input--error:hover, axa-input-text .a-input-text__input--error:active, axa-input-text .a-input-text__input--error:focus {\n  border: 1px solid #c91432;\n}\naxa-input-text .a-input-text__input--error:focus, axa-input-text .a-input-text__input--error.focus {\n  outline: 1px solid #c91432;\n  outline-offset: -2px;\n}\naxa-input-text .a-input-text__input:disabled, axa-input-text .a-input-text__input--readonly {\n  background-color: #fafafa;\n  border-color: #e5e5e5;\n  color: #999;\n  -webkit-text-fill-color: #999;\n  opacity: 1;\n}\naxa-input-text .a-input-text__input--check {\n  padding-right: 31px;\n}\naxa-input-text .a-input-text__label {\n  font-size: 16px;\n  letter-spacing: 0.02em;\n  line-height: 24px;\n  font-family: "Source Sans Pro", Arial, sans-serif;\n  display: block;\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 10px;\n}\naxa-input-text[disabled] .a-input-text__label, axa-input-text[readonly] .a-input-text__label {\n  color: #999;\n}\naxa-input-text .a-input-text__check {\n  display: block;\n  width: 26px;\n  height: 26px;\n  transform: rotate(45deg);\n  position: absolute;\n  top: 7px;\n  right: 5px;\n}\naxa-input-text .a-input-text__check:before {\n  content: "";\n  position: absolute;\n  top: 69%;\n  left: 22%;\n  height: 12%;\n  background: #1cc54e;\n  border-radius: 6px;\n  animation: short 0.3s ease-in forwards;\n}\naxa-input-text .a-input-text__check:after {\n  content: "";\n  position: absolute;\n  top: 80%;\n  left: 55%;\n  height: 12%;\n  background: #1cc54e;\n  border-radius: 6px;\n  transform: rotate(-90deg);\n  transform-origin: 0 0;\n  animation: long 0.3s ease-out 0.3s forwards;\n}\n@keyframes short {\n  0% {\n    width: 0;\n  }\n  100% {\n    width: 45%;\n  }\n}\n@keyframes long {\n  0% {\n    width: 0;\n  }\n  100% {\n    width: 70%;\n  }\n}\naxa-input-text .a-input-text__error {\n  font-size: 14px;\n  letter-spacing: 0.02em;\n  line-height: 17px;\n  font-family: "Source Sans Pro", Arial, sans-serif;\n  display: block;\n  color: #c91432;\n  margin-top: 10px;\n}\naxa-input-text .a-input-text__character-overflow-error {\n  color: #c91432;\n}\naxa-input-text .a-input-text__counter-info {\n  margin-top: 10px;\n}'}constructor(){super(),C(this),this.handleFocus=this.handleFocus.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleInput=this.handleInput.bind(this),this.nativeInput={value:""},this.modelValue="",this.isControlled=!1,this.isPlaceholderInCounter=!1,this.invalidFormat=!1;const t={"axa-input-text":{"axa-input-text":"6.0.2","axa-popup":"5.0.2"}},e=t["axa-input-text"]["axa-popup"];t[i.tagName]={[i.tagName]:e},t[r.tagName]={[r.tagName]:e},d([i,r],t,this)}get charsLeft(){const{maxLength:t=0,nativeInput:{value:e}}=this;return e?t-e.length:t}get areCharsLeft(){return this.charsLeft>0}get showCounter(){return this.maxLength>0&&!(this.invalid||this.invalidFormat)&&this.areCharsLeft&&this.counter&&!this.disabled&&!this.readonly}get showCounterMax(){return this.maxLength>0&&this.counterMax&&!this.showError&&!this.areCharsLeft&&!this.disabled&&!this.readonly}get showMessages(){return this.showError||this.showCounter||this.showCounterMax}get getCounterText(){const t=this.charsLeft-1;return this.counter&&this.isPlaceholderInCounter?this.counter.replace(/##.*##/,t):this.counter?`${t} ${this.counter}`:t}set value(t){const{isControlled:e}=this;e||void 0===t||(this.isControlled=!0);const n=this.modelValue;this.modelValue=t,this.requestUpdate("value",n)}get value(){if(!this.nativeInput)return"";const{isControlled:t,modelValue:e,nativeInput:{value:n}}=this;return t?e:n}get showError(){return this.error&&(this.invalid||this.invalidFormat)&&!this.disabled&&!this._open}get showCheckMark(){return this.checkMark&&0!==this.charsLeft}focus(t={}){this.nativeInput.focus(t),this.nativeInput.classList.add("focus")}blur(){this.nativeInput.blur(),this.nativeInput.classList.remove("focus")}handleFocus(t){this.nativeInput.classList.add("focus"),this.onFocus(t)}handleBlur(t){this.nativeInput.value=this._formatCurrency(this.value),this.modelCounter=this.getCounterText,this.nativeInput.classList.remove("focus"),this.onBlur(t)}handleInput(t){if(this._formatCurrency(t.target.value),this.onChange(t,this.invalidFormat),this.isControlled&&(this.nativeInput.value=this.modelValue),this.charsLeft<0&&this.maxLength){const{nativeInput:t}=this,e=t.value.substring(0,this.maxLength-1);t.value=e,this.modelValue=e,this.requestUpdate("value",e)}this.maxLength&&(this.modelCounter=this.getCounterText)}_isSafari(){return navigator&&navigator.vendor&&navigator.vendor.includes&&navigator.vendor.includes("Apple Computer")}_setNativeInput(){this.nativeInput=this.querySelector("input")}_formatCurrency(t){const{currency:e,type:n}=this;if(e&&"text"===n){const n=/\d/.test(t);if(this.currencyFormatter||(this.currencyFormatter=new Intl.NumberFormat("de-CH",{style:"currency",currency:e})),n){const e=t.replace(/[^0-9.]/g,"");if(!isNaN(e))return this.invalidFormat=!1,this.currencyFormatter.format(e)}this.invalidFormat=t.length>0}return t}firstUpdated(){const{defaultValue:t,isReact:e}=this;this._setNativeInput(),e&&t&&(this.nativeInput.value=this._formatCurrency(t)),this.isPlaceholderInCounter=this.counter&&/##.*##/.test(this.counter),this.modelCounter=this.getCounterText,this.autofocus&&this.focus()}updated(){this._setNativeInput()}render(){const{name:t,required:n,value:a,label:i="",error:r="",info:u="",type:p="",placeholder:l="",disabled:c,isReact:h,maxLength:d="",invalid:f,readonly:m,invalidFormat:g,checkMark:_,isControlled:v,refId:y,inputmode:b="",pattern:$=w,_open:C}=this;let k=a;document.activeElement!==this.nativeInput&&(k=this._formatCurrency(a)),this.isControlled=v&&h;const N={"a-input-text__input":!0,"a-input-text__input--readonly":m,"a-input-text__input--error":(f||g)&&!c||this.showCounterMax,"a-input-text__input--check":_&&!this.showCounterMax&&!c};return e`
      ${i&&e`
          <label for="${y}" class="a-input-text__label">
            ${i} ${n?e` * `:""}
          </label>
        `}
      <div class="a-input-text__input-wrapper">
        <div class="a-input-text__input-elements">
        ${this._isSafari()?e`
                <input
                  id="${y}"
                  type="${p}"
                  class="${o(N)}"
                  autocomplete="off"
                  name="${t}"
                  value="${k}"
                  placeholder="${l}"
                  aria-required="${n}"
                  maxlength="${d}"
                  pattern="${$}"
                  inputmode="${b}"
                  ?disabled="${c}"
                  ?readonly="${m}"
                  @input="${this.handleInput}"
                  @focus="${this.handleFocus}"
                  @blur="${this.handleBlur}"
                  @keyup="${this.onKeyUp}"
                />
              `:e`
                <input
                  id="${y}"
                  type="${p}"
                  class="${o(N)}"
                  autocomplete="off"
                  name="${t}"
                  .value="${k}"
                  placeholder="${l}"
                  aria-required="${n}"
                  maxlength="${d}"
                  pattern="${$}"
                  inputmode="${b}"
                  ?disabled="${c}"
                  ?readonly="${m}"
                  @input="${this.handleInput}"
                  @focus="${this.handleFocus}"
                  @blur="${this.handleBlur}"
                  @keyup="${this.onKeyUp}"
                />
              `}
          ${this.showCheckMark?e` <span class="a-input-text__check"></span> `:""}
        </div>
        ${u&&x(this)`
            <axa-popup-button
              ?open="${C}"
              class="a-input-text__info-button"
              @click="${this.handlePopupButtonClick}"
            ></axa-popup-button>
          `}
      </div>
        ${this.showError?e` <span class="a-input-text__error">${r}</span> `:""}
        ${this.showCounter?e`
                <div class="a-input-text__counter-info">
                  ${this.modelCounter}
                </div>
              `:""}
        ${this.showCounterMax?e`
                <div
                  class="a-input-text__counter-info a-input-text__character-overflow-error"
                >
                  ${this.counterMax}
                </div>
              `:""}
      </div>
      ${u?x(this)`
              <axa-popup-content
                ?open="${C}"
                class="a-input-text__info-content"
              >
                ${s(u)}
              </axa-popup-content>
            `:""}
  `}}d([k],{"axa-input-text":{"axa-input-text":"6.0.2","axa-popup":"5.0.2"}});var N=(e,n)=>((e,n,a)=>{const{tagName:i}=n,r=a?d([n],a):i,o=r.split("-").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(""),s=({children:a,...i})=>{const{attrs:o,props:s}=f(i,n);return t(e)(r,{isReact:!0,attrs:o,...s},a)};return s.displayName=o,s})(e,k,n);export{N as default};
