import{AXAPopupMixin as t,AXAPopupButton as e,AXAPopupContent as n}from"@axa-ch/popup";import{html as i,LitElement as a}from"lit";import{classMap as r}from"lit/directives/class-map.js";import{unsafeHTML as o}from"lit/directives/unsafe-html.js";var s=(t,e)=>{const n=t.toLowerCase();return window.customElements.get(n)||window.customElements.define(n,e),n};const u=(t,e)=>{return`${t}-${n=e,`${n}`.replace(/\./g,"-").replace(/[^A-Za-z0-9-]/g,"")}`;var n},l=(t,e="",n="<")=>`${n}${e}${t}`,p=(t,e,n)=>l(u(t,e),n,"{"),c=(t,e,n)=>t.map((t=>t.split(l(e)).join(p(e,n)).split(l(e,"/")).join(p(e,n,"/")))),h=(t,e,n)=>{const i="string"==typeof e&&e;let a="";return t.forEach((t=>{const r=t instanceof HTMLElement?t.constructor:t,{tagName:o}=r,l=!i&&e[o];if(l){if(!window.customElements.get(o)&&r.versions)throw Error(`'versions' is a reserved class property, but was found in ${o}'s class`);r.versions=l,s(o,r)}let{versions:p}=r;!p&&n&&(p=e[n.constructor.tagName],p[o]=Object.values(p)[0]);const c=i||p[o];a=u(o,c),s(a,class extends r{})})),a},d=t=>(e,...n)=>{const a=t.constructor,[r,o]=(t=>{const{versions:e,tagName:n}=t,i=Object.keys(e).filter((t=>t!==n)).sort(((t,e)=>e.length-t.length));return[i,i.map((t=>e[t]))]})(a);let s=e;for(let t=0,e=r.length;t<e;t++)s=c(s,r[t],o[t]);for(let t=0,e=s.length;t<e;t++)s[t]=s[t].split("{").join("<");return s.raw=s,i(s,...n)};var x=(t="")=>`${t}${Math.random().toString(36).slice(2)}`;const f={};class m extends a{inlineStyles(t="styles"){const e=this.getRootNode(),n=f[this.tagName]||new WeakMap,i=n.get(e)||{},a=(i.referenceCount||0)+1;if(i.referenceCount=a,n.set(e,a),f[this.tagName]=n,1===a){this.ownerDocument!==e&&(this._rootNode=e);const n=document.createElement("style");let a=this.constructor[t];const r=this.nodeName.toLowerCase(),o=this.constructor.tagName;r!==o&&(a=a.split(o).join(r)),n.textContent=a,n.dataset.name=this.tagName.toLowerCase();(e instanceof ShadowRoot?e:document.head).appendChild(n),i.style=n}n.set(e,i),f[this.tagName]=n}disconnectedCallback(){super.disconnectedCallback();const t=f[this.tagName];if(!t)return;const e=this._rootNode||this.ownerDocument,n=t.get(e)||{},i=(n.referenceCount||0)-1;if(i<1){t.delete(e);const{style:i}=n;i&&i.parentNode&&i.parentNode.removeChild(i)}else n.referenceCount=i,t.set(e,n)}}class g extends m{connectedCallback(){super.connectedCallback(),this.inlineStyles()}createRenderRoot(){return this}}const _=t=>!(null==t),v=new Map;[[String,""],[Boolean,!1],[Object,{}],[Array,[]],[Number,0],[Function,()=>{}]].forEach((([t,e])=>{v.set(t,e)}));const y=()=>{},b=t=>{const{constructor:{properties:e}}=t;Object.keys(e).forEach((n=>{const i=e[n],{type:a,converter:r,defaultValue:o}=i;if(!a){if(!r)throw new Error(`<${t.nodeName}> property "${n}" is missing a type!`);return}let s=t[n];_(s)||(s=a===Boolean?t.hasAttribute(n):t.getAttribute(n),_(s)?t[n]=((t,e)=>e===Number?parseFloat(t):e===Function?y:e===Array||e===Object?JSON.parse(t):t)(s,a):void 0===o&&"defaultValue"in i||(t[n]="defaultValue"in i?o:v.get(a)))}))};const $=".*";class C extends(t(g)){static get tagName(){return"axa-input-text"}static get properties(){return{refId:{type:String,defaultValue:`input-text-${x()}`},name:{type:String},label:{type:String},required:{type:Boolean},placeholder:{type:String},value:{type:String,defaultValue:void 0},defaultValue:{type:String},type:{type:String,defaultValue:"text"},error:{type:String},info:{type:String},invalid:{type:Boolean},checkMark:{type:Boolean},disabled:{type:Boolean,reflect:!0},isReact:{type:Boolean},modelCounter:{type:String},counter:{type:String},counterMax:{type:String},maxLength:{converter:t=>!isNaN(parseFloat(t))&&isFinite(t)?Number(t):void 0},inputmode:{type:String},currency:{type:String},pattern:{converter:t=>t||$},autofocus:{type:Boolean},readonly:{type:Boolean},onChange:{type:Function,attribute:!1},onFocus:{type:Function,attribute:!1},onBlur:{type:Function,attribute:!1},onKeyUp:{type:Function,attribute:!1}}}static get styles(){return'axa-input-text .a-input-text__input-wrapper {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\naxa-input-text .a-input-text__input-elements {\n  position: relative;\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\naxa-input-text .a-input-text__info-button {\n  margin-left: 10px;\n  width: 32px;\n  height: 32px;\n}\naxa-input-text .a-input-text__input {\n  font-size: 14px;\n  letter-spacing: 0.02em;\n  line-height: 17px;\n  font-family: "Source Sans Pro", Arial, sans-serif;\n  appearance: none;\n  background: #fff;\n  border: 1px solid #999;\n  border-radius: 0;\n  box-sizing: border-box;\n  color: #333;\n  height: 40px;\n  padding: 0 20px;\n  width: 100%;\n}\naxa-input-text .a-input-text__input::placeholder {\n  color: #999;\n}\naxa-input-text .a-input-text__input::-ms-clear {\n  display: none;\n}\naxa-input-text .a-input-text__input:hover, axa-input-text .a-input-text__input:active, axa-input-text .a-input-text__input:focus {\n  border: 1px solid #00008f;\n}\naxa-input-text .a-input-text__input:focus, axa-input-text .a-input-text__input.focus {\n  border: 1px solid #00008f;\n  outline: 1px solid #00008f;\n  outline-offset: -2px;\n}\naxa-input-text .a-input-text__input--error {\n  border: 1px solid #c91432;\n}\naxa-input-text .a-input-text__input--error:hover, axa-input-text .a-input-text__input--error:active, axa-input-text .a-input-text__input--error:focus {\n  border: 1px solid #c91432;\n}\naxa-input-text .a-input-text__input--error:focus, axa-input-text .a-input-text__input--error.focus {\n  outline: 1px solid #c91432;\n  outline-offset: -2px;\n}\naxa-input-text .a-input-text__input:disabled, axa-input-text .a-input-text__input--readonly {\n  background-color: #fafafa;\n  border-color: #e5e5e5;\n  color: #999;\n  -webkit-text-fill-color: #999;\n  opacity: 1;\n}\naxa-input-text .a-input-text__input--check {\n  padding-right: 31px;\n}\naxa-input-text .a-input-text__label {\n  font-size: 16px;\n  letter-spacing: 0.02em;\n  line-height: 24px;\n  font-family: "Source Sans Pro", Arial, sans-serif;\n  display: block;\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 10px;\n}\naxa-input-text[disabled] .a-input-text__label, axa-input-text[readonly] .a-input-text__label {\n  color: #999;\n}\naxa-input-text .a-input-text__check {\n  display: block;\n  width: 26px;\n  height: 26px;\n  transform: rotate(45deg);\n  position: absolute;\n  top: 7px;\n  right: 5px;\n}\naxa-input-text .a-input-text__check:before {\n  content: "";\n  position: absolute;\n  top: 69%;\n  left: 22%;\n  height: 12%;\n  background: #1cc54e;\n  border-radius: 6px;\n  animation: short 0.3s ease-in forwards;\n}\naxa-input-text .a-input-text__check:after {\n  content: "";\n  position: absolute;\n  top: 80%;\n  left: 55%;\n  height: 12%;\n  background: #1cc54e;\n  border-radius: 6px;\n  transform: rotate(-90deg);\n  transform-origin: 0 0;\n  animation: long 0.3s ease-out 0.3s forwards;\n}\n@keyframes short {\n  0% {\n    width: 0;\n  }\n  100% {\n    width: 45%;\n  }\n}\n@keyframes long {\n  0% {\n    width: 0;\n  }\n  100% {\n    width: 70%;\n  }\n}\naxa-input-text .a-input-text__error {\n  font-size: 14px;\n  letter-spacing: 0.02em;\n  line-height: 17px;\n  font-family: "Source Sans Pro", Arial, sans-serif;\n  display: block;\n  color: #c91432;\n  margin-top: 10px;\n}\naxa-input-text .a-input-text__character-overflow-error {\n  color: #c91432;\n}\naxa-input-text .a-input-text__counter-info {\n  margin-top: 10px;\n}'}constructor(){super(),b(this),this.handleFocus=this.handleFocus.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleInput=this.handleInput.bind(this),this.nativeInput={value:""},this.modelValue="",this.isControlled=!1,this.isPlaceholderInCounter=!1,this.invalidFormat=!1;const t={"axa-input-text":{"axa-input-text":"6.0.2","axa-popup":"5.0.2"}},i=t["axa-input-text"]["axa-popup"];t[e.tagName]={[e.tagName]:i},t[n.tagName]={[n.tagName]:i},h([e,n],t,this)}get charsLeft(){const{maxLength:t=0,nativeInput:{value:e}}=this;return e?t-e.length:t}get areCharsLeft(){return this.charsLeft>0}get showCounter(){return this.maxLength>0&&!(this.invalid||this.invalidFormat)&&this.areCharsLeft&&this.counter&&!this.disabled&&!this.readonly}get showCounterMax(){return this.maxLength>0&&this.counterMax&&!this.showError&&!this.areCharsLeft&&!this.disabled&&!this.readonly}get showMessages(){return this.showError||this.showCounter||this.showCounterMax}get getCounterText(){const t=this.charsLeft-1;return this.counter&&this.isPlaceholderInCounter?this.counter.replace(/##.*##/,t):this.counter?`${t} ${this.counter}`:t}set value(t){const{isControlled:e}=this;e||void 0===t||(this.isControlled=!0);const n=this.modelValue;this.modelValue=t,this.requestUpdate("value",n)}get value(){if(!this.nativeInput)return"";const{isControlled:t,modelValue:e,nativeInput:{value:n}}=this;return t?e:n}get showError(){return this.error&&(this.invalid||this.invalidFormat)&&!this.disabled&&!this._open}get showCheckMark(){return this.checkMark&&0!==this.charsLeft}focus(t={}){this.nativeInput.focus(t),this.nativeInput.classList.add("focus")}blur(){this.nativeInput.blur(),this.nativeInput.classList.remove("focus")}handleFocus(t){this.nativeInput.classList.add("focus"),this.onFocus(t)}handleBlur(t){this.nativeInput.value=this._formatCurrency(this.value),this.modelCounter=this.getCounterText,this.nativeInput.classList.remove("focus"),this.onBlur(t)}handleInput(t){if(this._formatCurrency(t.target.value),this.onChange(t,this.invalidFormat),this.isControlled&&(this.nativeInput.value=this.modelValue),this.charsLeft<0&&this.maxLength){const{nativeInput:t}=this,e=t.value.substring(0,this.maxLength-1);t.value=e,this.modelValue=e,this.requestUpdate("value",e)}this.maxLength&&(this.modelCounter=this.getCounterText)}_isSafari(){return navigator&&navigator.vendor&&navigator.vendor.includes&&navigator.vendor.includes("Apple Computer")}_setNativeInput(){this.nativeInput=this.querySelector("input")}_formatCurrency(t){const{currency:e,type:n}=this;if(e&&"text"===n){const n=/\d/.test(t);if(this.currencyFormatter||(this.currencyFormatter=new Intl.NumberFormat("de-CH",{style:"currency",currency:e})),n){const e=t.replace(/[^0-9.]/g,"");if(!isNaN(e))return this.invalidFormat=!1,this.currencyFormatter.format(e)}this.invalidFormat=t.length>0}return t}firstUpdated(){const{defaultValue:t,isReact:e}=this;this._setNativeInput(),e&&t&&(this.nativeInput.value=this._formatCurrency(t)),this.isPlaceholderInCounter=this.counter&&/##.*##/.test(this.counter),this.modelCounter=this.getCounterText,this.autofocus&&this.focus()}updated(){this._setNativeInput()}render(){const{name:t,required:e,value:n,label:a="",error:s="",info:u="",type:l="",placeholder:p="",disabled:c,isReact:h,maxLength:x="",invalid:f,readonly:m,invalidFormat:g,checkMark:_,isControlled:v,refId:y,inputmode:b="",pattern:C=$,_open:w}=this;let k=n;document.activeElement!==this.nativeInput&&(k=this._formatCurrency(n)),this.isControlled=v&&h;const N={"a-input-text__input":!0,"a-input-text__input--readonly":m,"a-input-text__input--error":(f||g)&&!c||this.showCounterMax,"a-input-text__input--check":_&&!this.showCounterMax&&!c};return i`
      ${a&&i`
          <label for="${y}" class="a-input-text__label">
            ${a} ${e?i` * `:""}
          </label>
        `}
      <div class="a-input-text__input-wrapper">
        <div class="a-input-text__input-elements">
        ${this._isSafari()?i`
                <input
                  id="${y}"
                  type="${l}"
                  class="${r(N)}"
                  autocomplete="off"
                  name="${t}"
                  value="${k}"
                  placeholder="${p}"
                  aria-required="${e}"
                  maxlength="${x}"
                  pattern="${C}"
                  inputmode="${b}"
                  ?disabled="${c}"
                  ?readonly="${m}"
                  @input="${this.handleInput}"
                  @focus="${this.handleFocus}"
                  @blur="${this.handleBlur}"
                  @keyup="${this.onKeyUp}"
                />
              `:i`
                <input
                  id="${y}"
                  type="${l}"
                  class="${r(N)}"
                  autocomplete="off"
                  name="${t}"
                  .value="${k}"
                  placeholder="${p}"
                  aria-required="${e}"
                  maxlength="${x}"
                  pattern="${C}"
                  inputmode="${b}"
                  ?disabled="${c}"
                  ?readonly="${m}"
                  @input="${this.handleInput}"
                  @focus="${this.handleFocus}"
                  @blur="${this.handleBlur}"
                  @keyup="${this.onKeyUp}"
                />
              `}
          ${this.showCheckMark?i` <span class="a-input-text__check"></span> `:""}
        </div>
        ${u&&d(this)`
            <axa-popup-button
              ?open="${w}"
              class="a-input-text__info-button"
              @click="${this.handlePopupButtonClick}"
            ></axa-popup-button>
          `}
      </div>
        ${this.showError?i` <span class="a-input-text__error">${s}</span> `:""}
        ${this.showCounter?i`
                <div class="a-input-text__counter-info">
                  ${this.modelCounter}
                </div>
              `:""}
        ${this.showCounterMax?i`
                <div
                  class="a-input-text__counter-info a-input-text__character-overflow-error"
                >
                  ${this.counterMax}
                </div>
              `:""}
      </div>
      ${u?d(this)`
              <axa-popup-content
                ?open="${w}"
                class="a-input-text__info-content"
              >
                ${o(u)}
              </axa-popup-content>
            `:""}
  `}}h([C],{"axa-input-text":{"axa-input-text":"6.0.2","axa-popup":"5.0.2"}});export{C as default};
